################### 
#CLUSTER PARTICION#
###################


############################
#CLUSTER K-MEANS JERARQUICO#
############################



NO ESTANDAARIZO PORQUE MIS VARIABLES ESTAN EN UNA ESCALA DE 1-7


#Si deseamos estandarizar
#datos.s <- as.data.frame(scale(datosc))#datos originales#estan en la misma escala 1-7

library(foreign)
datosc <- read.spss("compras-cluster.sav",
                    use.value.labels=TRUE, 
                    max.value.labels=TRUE,
                    to.data.frame=TRUE)

attr(datosc,"variable.labels") <- NULL
datosc$caso <- NULL
str(datosc)

#lo mejor de k-means con lo mejor del jerarquico.

library(factoextra)

res.hk <- hkmeans(datosc, 3,#quiero 3 cluster esto sale del cluster jerarquico.
                  hc.metric = "euclidean", #jerarquico
                  hc.method = "ward.D2",   #jerarquico
                  iter.max = 10)#no necesita muchas iteracciones ya que combinamos al jerarquico y kmeas

#numero de iteraciones
res.hk$iter
#1

# Elementos que retorna hkmeans()
names(res.hk)

# Mostrar los resultados
res.hk

#asignacion de los individuos a cada cluster
res.hk$cluster

#juntando datosc y los clusters
head(cbind(datosc,cluster=res.hk$cluster))

#promedios 
res.hk$centers


#tammaÃ±o de cad cluster
res.hk$size

#juntando datosc y los clusters
datos.hk <- cbind(datosc,grp=as.factor(res.hk$cluster))

#########
#grafica#
#########

#insumo    "res.hk$cluster   y datosc"  #asignacion de los individuos a cada cluster


library(factoextra)
fviz_cluster(list(data = datosc, cluster = res.hk$cluster),
             palette = c("#2E9FDF",  "#E7B800", "#FC4E07"),
             ellipse.type = "convex", # Concentration ellipse
             repel = T, # Avoid label overplotting (slow)
             show.clust.cent = FALSE, ggtheme = theme_bw())